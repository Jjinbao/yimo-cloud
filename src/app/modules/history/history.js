angular.module('ymy.history',[])
    .controller('historyRecord',['$scope','$state','$ionicViewSwitcher',function($scope,$state,$ionicViewSwitcher){
        $scope.$on('$ionicView.beforeEnter',function(){
            $scope.hideTabBar('hide');
        })
        $scope.toPart=function(val){
            if(val=='应用'){
                $state.go('application',{});
            }else if(val=='资讯'){
                $state.go('infoMsg',{});
            }else if(val=='教学'){
                $state.go('teaching',{});
            }
            $ionicViewSwitcher.nextDirection('forward');
        }

    }])
    .controller('application',['$scope','$state','$http','$ionicViewSwitcher','userService',function($scope,$state,$http,$ionicViewSwitcher,userService){
        $scope.appList='';
        $http({
            url:urlStr+'ym/history/list.api',
            method:'POST',
            params:{
                accountId:userService.userMess.accountId,
                type:'app',
                sign:md5('ymy'+userService.userMess.accountId+'app')
            }
        }).success(function(data){
            console.log(data);
            if(data.result==1){
                $scope.appList=data.list;
            }
        })
    }])
    .controller('teaching',['$scope','$state','$http','$ionicViewSwitcher','userService',function($scope,$state,$http,$ionicViewSwitcher,userService){
        $scope.panelType='sp'
        $scope.teachChoice=function(val){
            if($scope.panelType==val){
                return;
            }
            $scope.panelType=val;
        }
        $scope.teachInfo=[];
        $http({
            url:urlStr+'ym/history/list.api',
            method:'POST',
            params:{
                accountId:userService.userMess.accountId,
                type:'teach',
                sign:md5('ymy'+userService.userMess.accountId+'teach')
            }
        }).success(function(data){
            console.log(data);
            if(data.result==1){
                $scope.teachInfo=data.list;
            }
        })

        $scope.toTeachVideo=function(val){
            $state.go('videoDetail',{rootId:1,id:val.teach.id,vsrc:val.teach.videoSrc});
            $ionicViewSwitcher.nextDirection('forward');
        }
    }])
    .controller('information',['$scope','$state','$http','$ionicViewSwitcher','userService',function($scope,$state,$http,$ionicViewSwitcher,userService){
        console.log('应用列表');
        $scope.infoList=[];
        $http({
            url:urlStr+'ym/history/list.api',
            method:'POST',
            params:{
                accountId:userService.userMess.accountId,
                type:'news',
                sign:md5('ymy'+userService.userMess.accountId+'news')
            }
        }).success(function(data){
            if(data.result==1){
                $scope.infoList=data.list;
            }
            console.log(data);
        })

        $scope.toInfoDetail=function(val){
            console.log(val);
            //$state.go('videoDetail',{rootId:9,id:val.teach.id,vsrc:val.teach.videoSrc});
            //$ionicViewSwitcher.nextDirection('forward');
        }
    }])
